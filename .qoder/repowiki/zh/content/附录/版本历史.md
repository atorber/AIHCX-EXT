# ç‰ˆæœ¬å†å²

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**
- [CHANGELOG.md](file://CHANGELOG.md)
- [RELEASE.md](file://RELEASE.md)
- [DataDownloadHandler.ts](file://src/handlers/pages/DataDownloadHandler.ts)
- [DataDownloadInput.tsx](file://src/components/DataDownloadInput.tsx)
- [DataDumpForm.tsx](file://src/components/DataDumpForm.tsx)
- [aihcApi.ts](file://src/services/aihcApi.ts)
</cite>

## ç›®å½•
1. [ç‰ˆæœ¬æ¦‚è§ˆ](#ç‰ˆæœ¬æ¦‚è§ˆ)
2. [è¯¦ç»†ç‰ˆæœ¬è®°å½•](#è¯¦ç»†ç‰ˆæœ¬è®°å½•)
3. [è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹](#è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹)
4. [é‡å¤§æ›´æ–°è¯´æ˜](#é‡å¤§æ›´æ–°è¯´æ˜)

## ç‰ˆæœ¬æ¦‚è§ˆ

AIHCåŠ©æ‰‹æµè§ˆå™¨æ‰©å±•éµå¾ª[è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)è§„èŒƒï¼Œæ‰€æœ‰é‡è¦å˜æ›´å‡è®°å½•åœ¨`CHANGELOG.md`æ–‡ä»¶ä¸­ã€‚é¡¹ç›®é‡‡ç”¨è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹ï¼Œç¡®ä¿ç‰ˆæœ¬çš„ä¸€è‡´æ€§å’Œå¯è¿½æº¯æ€§ã€‚

å½“å‰å·²çŸ¥çš„æœ€é«˜ç‰ˆæœ¬ä¸º **0.5.0**ï¼Œäº2024å¹´1æœˆå‘å¸ƒã€‚è¯¥ç‰ˆæœ¬ä¸ºé¦–æ¬¡æ­£å¼å‘å¸ƒï¼ŒåŒ…å«äº†æ ¸å¿ƒåŠŸèƒ½é›†å’Œå¯¹å¤šç§AIHCæ§åˆ¶å°é¡µé¢çš„æ”¯æŒã€‚

**ç‰ˆæœ¬å·å«ä¹‰ï¼š**
- **ä¸»ç‰ˆæœ¬å· (MAJOR)**: ä¸å…¼å®¹çš„APIä¿®æ”¹
- **æ¬¡ç‰ˆæœ¬å· (MINOR)**: å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- **ä¿®è®¢å· (PATCH)**: å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

## è¯¦ç»†ç‰ˆæœ¬è®°å½•

### [0.5.0] - 2024-01-XX

#### æ–°å¢
- ğŸ‰ é¦–æ¬¡å‘å¸ƒAIHCåŠ©æ‰‹æµè§ˆå™¨æ‰©å±•
- ğŸ¯ æ™ºèƒ½é¡µé¢è¯†åˆ«åŠŸèƒ½ï¼Œè‡ªåŠ¨è¯†åˆ«AIHCæ§åˆ¶å°çš„å„ç§é¡µé¢
- ğŸ”§ CLIå‘½ä»¤ç”ŸæˆåŠŸèƒ½ï¼Œä¸€é”®ç”Ÿæˆå¯¹åº”çš„å‘½ä»¤è¡Œå·¥å…·å‘½ä»¤
- ğŸ“„ å‚æ•°æ ¼å¼åŒ–åŠŸèƒ½ï¼Œæ”¯æŒJSONå’ŒYAMLæ ¼å¼
- ğŸ“š APIæ–‡æ¡£æŸ¥çœ‹åŠŸèƒ½
- ğŸ¨ åŸºäºReactçš„ç°ä»£åŒ–ç”¨æˆ·ç•Œé¢
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸
- âœ… æ”¯æŒæ•°æ®ä¸‹è½½é¡µé¢ï¼ˆ`/dataDownload/create`ï¼‰
- âœ… æ”¯æŒæ•°æ®è½¬å‚¨ä»»åŠ¡è¯¦æƒ…é¡µé¢ï¼ˆ`/dataDownload/info`ï¼‰

#### å˜æ›´
- æ— 

#### ä¿®å¤
- æ— 

#### ç§»é™¤
- æ— 

**Section sources**
- [CHANGELOG.md](file://CHANGELOG.md#L7-L68)

## è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

é¡¹ç›®çš„å‘å¸ƒæµç¨‹å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œé€šè¿‡GitHub Actionså®ç°ï¼Œç¡®ä¿äº†æ¯æ¬¡å‘å¸ƒçš„é«˜è´¨é‡ã€å¯é‡å¤æ€§å’Œå¯è¿½æº¯æ€§ã€‚

### å‘å¸ƒæ­¥éª¤

1.  **å‡†å¤‡å‘å¸ƒ**ï¼šç¡®ä¿æ‰€æœ‰åŠŸèƒ½å®Œæˆæµ‹è¯•ï¼Œæ›´æ–°`package.json`ä¸­çš„ç‰ˆæœ¬å·å’Œ`CHANGELOG.md`æ–‡ä»¶ã€‚
2.  **æœ¬åœ°æµ‹è¯•**ï¼šè¿è¡Œ `npm run test-release` è¿›è¡Œå®Œæ•´çš„å‘å¸ƒæµç¨‹æµ‹è¯•ã€‚
3.  **åˆ›å»ºGitæ ‡ç­¾**ï¼šä½¿ç”¨ `git tag v0.5.0` åˆ›å»ºæ ‡ç­¾ï¼Œå¹¶é€šè¿‡ `git push origin v0.5.0` æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚
4.  **è‡ªåŠ¨å‘å¸ƒ**ï¼šæ¨é€æ ‡ç­¾åï¼ŒGitHub Actionsä¼šè‡ªåŠ¨è§¦å‘ä»¥ä¸‹æµç¨‹ï¼š
    *   æ£€å‡ºä»£ç 
    *   è®¾ç½®Node.jsç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
    *   è¿è¡ŒTypeScriptç±»å‹æ£€æŸ¥
    *   æ„å»ºç”Ÿäº§ç‰ˆæœ¬
    *   æ‰“åŒ…ä¸ºZIPæ–‡ä»¶
    *   åœ¨GitHubä¸Šåˆ›å»ºæ–°çš„Release
    *   ä¸Šä¼ æ‰©å±•åŒ…ä½œä¸ºå‘å¸ƒèµ„æº

### å‘å¸ƒäº§ç‰©

æ¯æ¬¡å‘å¸ƒéƒ½ä¼šç”Ÿæˆä»¥ä¸‹äº§ç‰©ï¼š
- **GitHub Release**ï¼šåŒ…å«è¯¦ç»†çš„å‘å¸ƒè¯´æ˜å’Œè‡ªåŠ¨ç”Ÿæˆçš„å˜æ›´æ—¥å¿—ã€‚
- **æ‰©å±•åŒ…æ–‡ä»¶**ï¼š`aihc-helper-extension-v{version}.zip`ï¼Œå¯ç›´æ¥ä¸‹è½½å¹¶å®‰è£…åˆ°Chromeæµè§ˆå™¨ã€‚
- **æ„å»ºäº§ç‰©**ï¼š`dist/`ç›®å½•ä¸‹çš„å®Œæ•´æ‰©å±•ç¨‹åºæ–‡ä»¶ã€‚

```mermaid
flowchart TD
A[å¼€å‘è€…æäº¤ä»£ç ] --> B[æ¨é€Gitæ ‡ç­¾]
B --> C[GitHub Actionsè§¦å‘]
C --> D[æ£€å‡ºä»£ç ]
D --> E[è®¾ç½®ç¯å¢ƒ]
E --> F[å®‰è£…ä¾èµ–]
F --> G[ç±»å‹æ£€æŸ¥]
G --> H[æ„å»ºæ‰©å±•]
H --> I[æ‰“åŒ…ZIP]
I --> J[åˆ›å»ºGitHub Release]
J --> K[ä¸Šä¼ èµ„æº]
K --> L[å‘å¸ƒå®Œæˆ]
style A fill:#f9f,stroke:#333
style L fill:#bbf,stroke:#333
```

**Diagram sources**
- [RELEASE.md](file://RELEASE.md#L10-L191)

**Section sources**
- [RELEASE.md](file://RELEASE.md#L10-L191)

## é‡å¤§æ›´æ–°è¯´æ˜

### æ”¯æŒæ–°çš„é¡µé¢ç±»å‹ï¼šæ•°æ®ä¸‹è½½ä¸æ•°æ®è½¬å‚¨

åœ¨ **v0.5.0** ç‰ˆæœ¬ä¸­ï¼Œæ‰©å±•å¢åŠ äº†å¯¹ä¸¤ç§å…³é”®é¡µé¢ç±»å‹çš„æ”¯æŒï¼š

1.  **æ•°æ®ä¸‹è½½é¡µé¢ (`/dataDownload/create`)**:
    *   **åŠŸèƒ½**ï¼šå½“ç”¨æˆ·è®¿é—®æ­¤é¡µé¢æ—¶ï¼Œæ‰©å±•ä¼šæ£€æµ‹åˆ°è¿™æ˜¯ä¸€ä¸ªæ•°æ®ä¸‹è½½è¯·æ±‚ï¼Œå¹¶æä¾›ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œå…è®¸ç”¨æˆ·ç²˜è´´HuggingFaceæ•°æ®é›†æˆ–æ¨¡å‹çš„URLã€‚
    *   **å®ç°**ï¼šç”± `DataDownloadHandler` å¤„ç†å™¨å¤„ç†ï¼Œå®ƒä¼šå°†é¡µé¢æ ‡è®°ä¸º `isDataDownloadPage: true`ï¼Œä»è€Œè§¦å‘UIæ˜¾ç¤º `DataDownloadInput` ç»„ä»¶ã€‚
    *   **å½±å“**ï¼šæå¤§åœ°ç®€åŒ–äº†ä»HuggingFaceå¯¼å…¥æ•°æ®çš„è¿‡ç¨‹ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨å¡«å†™å¤æ‚çš„è¡¨å•ã€‚

2.  **æ•°æ®è½¬å‚¨ä»»åŠ¡è¯¦æƒ…é¡µé¢ (`/dataDownload/info`)**:
    *   **åŠŸèƒ½**ï¼šæ­¤é¡µé¢ç”¨äºé…ç½®å’Œæäº¤æ•°æ®è½¬å‚¨ä»»åŠ¡ã€‚æ‰©å±•ä¼šåœ¨æ­¤é¡µé¢ä¸Šæ˜¾ç¤ºä¸€ä¸ªä¸“é—¨çš„è¡¨å•ï¼Œå¸®åŠ©ç”¨æˆ·é€‰æ‹©èµ„æºæ± ã€é˜Ÿåˆ—ã€PFSå®ä¾‹å’Œå­˜å‚¨è·¯å¾„ã€‚
    *   **å®ç°**ï¼šåŒæ ·ç”± `DataDownloadHandler` å¤„ç†ï¼Œä½†æ ¹æ® `_pageName` çš„å€¼å°†å…¶æ ‡è®°ä¸º `isDataDumpPage: true`ï¼Œä»è€Œè§¦å‘UIæ˜¾ç¤º `DataDumpForm` ç»„ä»¶ã€‚
    *   **æŠ€æœ¯ç»†èŠ‚**ï¼š`DataDumpForm` ç»„ä»¶é€šè¿‡è°ƒç”¨ `aihcApiService` ä¸­çš„ `getPFSInstances` ç­‰æ–¹æ³•ï¼ŒåŠ¨æ€è·å–å¯ç”¨çš„PFSå®ä¾‹åˆ—è¡¨ï¼Œå®ç°äº†æ™ºèƒ½åŒ–çš„èµ„æºé…ç½®ã€‚

```mermaid
classDiagram
class DataDownloadHandler {
+handle(pageName, params) Promise~Partial~TaskParams~~
}
class DataDownloadInput {
+onParseUrl(parsedData)
+parseHuggingFaceUrl(url)
+fillPageForm(parsed)
}
class DataDumpForm {
+onSubmit(config)
+loadResourcePools()
+loadQueues(resourcePoolId)
+loadPFSInstances(resourcePoolId)
}
class aihcApiService {
+getSelfManagedResourcePools()
+getFullyManagedResourcePools()
+getPFSInstances(resourcePoolId, type)
+submitDataDumpTask(template)
}
DataDownloadHandler --> DataDownloadInput : "åœ¨ isDataDownloadPage æ—¶æ˜¾ç¤º"
DataDownloadHandler --> DataDumpForm : "åœ¨ isDataDumpPage æ—¶æ˜¾ç¤º"
DataDumpForm --> aihcApiService : "è°ƒç”¨APIè·å–èµ„æºä¿¡æ¯"
```

**Diagram sources**
- [DataDownloadHandler.ts](file://src/handlers/pages/DataDownloadHandler.ts#L7-L41)
- [DataDownloadInput.tsx](file://src/components/DataDownloadInput.tsx#L14-L369)
- [DataDumpForm.tsx](file://src/components/DataDumpForm.tsx#L14-L709)
- [aihcApi.ts](file://src/services/aihcApi.ts#L1-L558)

**Section sources**
- [DataDownloadHandler.ts](file://src/handlers/pages/DataDownloadHandler.ts#L7-L41)
- [DataDownloadInput.tsx](file://src/components/DataDownloadInput.tsx#L14-L369)
- [DataDumpForm.tsx](file://src/components/DataDumpForm.tsx#L14-L709)
- [aihcApi.ts](file://src/services/aihcApi.ts#L1-L558)

### CLIå‘½ä»¤ç”Ÿæˆèƒ½åŠ›å¢å¼º

è™½ç„¶v0.5.0æ˜¯é¦–æ¬¡å‘å¸ƒï¼Œä½†å…¶CLIå‘½ä»¤ç”ŸæˆåŠŸèƒ½å·²ç»å…·å¤‡å¼ºå¤§èƒ½åŠ›ï¼š
*   **å¤šæ ¼å¼æ”¯æŒ**ï¼šä¸ä»…ç”ŸæˆCLIå‘½ä»¤ï¼Œè¿˜æ”¯æŒä»¥JSONå’ŒYAMLæ ¼å¼å±•ç¤ºå‚æ•°ã€‚
*   **ä¸€é”®å¤åˆ¶**ï¼šç”¨æˆ·å¯ä»¥ç‚¹å‡»æŒ‰é’®ç›´æ¥å°†å‘½ä»¤å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚
*   **æ–‡æ¡£é“¾æ¥**ï¼šä¸ºæ¯ä¸ªå‘½ä»¤æä¾›æŒ‡å‘å®˜æ–¹CLIä½¿ç”¨æ‰‹å†Œçš„é“¾æ¥ã€‚

### æ€§èƒ½ä¼˜åŒ–

å°½ç®¡åœ¨åˆå§‹ç‰ˆæœ¬ä¸­æœªæ˜ç¡®åˆ—å‡ºæ€§èƒ½ä¼˜åŒ–é¡¹ï¼Œä½†å…¶æ¶æ„è®¾è®¡æœ¬èº«å°±ä½“ç°äº†æ€§èƒ½è€ƒé‡ï¼š
*   **æŒ‰éœ€åŠ è½½**ï¼šé€šè¿‡ `PageHandlerManager` åŠ¨æ€ç®¡ç†é¡µé¢å¤„ç†å™¨ï¼Œåªåœ¨éœ€è¦æ—¶æ‰å¤„ç†ç‰¹å®šé¡µé¢çš„æ•°æ®ã€‚
*   **å¼‚æ­¥å¤„ç†**ï¼šæ‰€æœ‰APIè°ƒç”¨å‡ä¸ºå¼‚æ­¥æ“ä½œï¼Œé¿å…é˜»å¡UIçº¿ç¨‹ã€‚
*   **è¯·æ±‚å–æ¶ˆæœºåˆ¶**ï¼šåœ¨ `DataDumpForm` ä¸­ä½¿ç”¨ `AbortController` å®ç°äº†è¯·æ±‚å–æ¶ˆï¼Œé˜²æ­¢å› å¿«é€Ÿåˆ‡æ¢é€‰é¡¹è€Œäº§ç”Ÿè¿‡å¤šç½‘ç»œè¯·æ±‚ã€‚
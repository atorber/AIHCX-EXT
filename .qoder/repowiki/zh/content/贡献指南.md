# 贡献指南

<cite>
**Referenced Files in This Document**   
- [package.json](file://package.json)
- [tsconfig.json](file://tsconfig.json)
- [vite.config.ts](file://vite.config.ts)
- [test-release.js](file://scripts/test-release.js)
- [README.md](file://README.md)
</cite>

## 目录
1. [贡献流程](#贡献流程)
2. [代码规范](#代码规范)
3. [测试要求](#测试要求)
4. [提交前验证](#提交前验证)

## 贡献流程

本项目欢迎社区成员的贡献。为了确保代码质量和协作效率，请遵循以下标准工作流：

1. **Fork仓库**：在GitHub上点击"Fork"按钮，创建您自己的仓库副本。
2. **克隆本地**：将您的Fork克隆到本地开发环境。
   ```bash
   git clone https://github.com/your-username/AIHCX-EXT.git
   ```
3. **创建特性分支**：基于`main`分支创建新的特性分支，使用清晰的命名约定（如`feature/description`或`fix/issue-name`）。
   ```bash
   git checkout -b feature/new-ui-component
   ```
4. **开发与提交**：在分支上进行开发，完成功能后提交更改。
5. **同步上游**：在提交Pull Request前，同步主仓库的最新更改以避免冲突。
   ```bash
   git fetch upstream
   git merge upstream/main
   ```
6. **推送分支**：将特性分支推送到您的Fork。
   ```bash
   git push origin feature/new-ui-component
   ```
7. **创建Pull Request**：在GitHub上从您的分支创建Pull Request到主仓库的`main`分支，并提供详细的描述说明更改内容。

**Section sources**
- [README.md](file://README.md#L400-L415)

## 代码规范

为保持代码库的一致性和可维护性，所有贡献必须遵守以下代码规范：

### TypeScript严格模式
项目已启用TypeScript严格模式，确保类型安全和代码质量。`tsconfig.json`配置文件中启用了以下严格选项：
- `strict`: 启用所有严格的类型检查选项
- `noUnusedLocals`: 禁止声明但未使用的局部变量
- `noUnusedParameters`: 禁止声明但未使用的参数
- `noFallthroughCasesInSwitch`: 在switch语句中禁止case穿透

### 格式化规则
虽然项目当前未显式配置ESLint和Prettier，但建议遵循现代TypeScript项目的通用格式化实践：
- 使用4个空格进行缩进
- 每行代码不超过80个字符
- 使用单引号表示字符串字面量
- 在对象字面量的冒号后添加一个空格
- 在函数参数列表和调用中，逗号后添加一个空格

### 注释与文档
- 为所有公共函数、类和接口编写JSDoc注释
- 复杂逻辑处添加内联注释解释实现思路
- 组件应包含简要的功能描述和使用示例
- 修改现有代码时，更新相关注释以反映最新状态

**Section sources**
- [tsconfig.json](file://tsconfig.json#L0-L21)
- [README.md](file://README.md#L417-L420)

## 测试要求

尽管项目目前尚未建立单元测试框架（搜索未发现`.test.ts`或`.spec.ts`文件），但我们高度重视代码质量保证。我们鼓励贡献者：

1. **手动测试**：在提交前彻底测试您的更改，确保新功能按预期工作且不破坏现有逻辑。
2. **边界情况验证**：测试各种输入条件和边缘情况，确保代码健壮性。
3. **跨浏览器兼容性**：验证扩展在不同Chrome版本中的表现一致性。

未来计划引入自动化测试框架，包括：
- 单元测试：使用Jest测试核心工具函数和业务逻辑
- 集成测试：验证组件间的交互和数据流
- E2E测试：模拟用户操作流程确保整体功能正确性

**Section sources**
- [README.md](file://README.md#L421-L424)

## 提交前验证

在提交Pull Request之前，必须执行以下验证命令以确保代码质量和构建稳定性：

### 类型检查
运行TypeScript编译器进行类型检查，确保没有类型错误：
```bash
npm run type-check
```
此命令执行`"tsc --noEmit"`，仅进行类型检查而不生成输出文件。

### 构建验证
执行完整构建流程，验证代码可以成功编译：
```bash
npm run build
```

### 发布流程测试
运行完整的发布流程测试脚本，模拟CI/CD环境下的构建和打包过程：
```bash
npm run test-release
```
该脚本会依次执行：
1. 环境检查（Node.js、npm、Git版本）
2. 依赖安装（`npm ci`）
3. 类型检查（`npm run type-check`）
4. 扩展构建（`npm run build`）
5. 扩展打包（`npm run package`）
6. 构建产物验证（检查dist目录、manifest.json、图标文件和ZIP包）

只有当所有验证命令均成功通过时，才能提交Pull Request。

**Section sources**
- [package.json](file://package.json#L6-L20)
- [test-release.js](file://scripts/test-release.js#L1-L125)